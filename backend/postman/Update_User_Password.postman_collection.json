{
  "info": {
    "name": "Update User Password",
    "description": "Collection for updating user passwords in the Fama University App",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Update User Password - Admin",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}",
            "description": "Admin JWT token"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"newPassword\": \"newSecurePassword123\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/users/{{user_id}}/password",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "api",
            "users",
            "{{user_id}}",
            "password"
          ]
        },
        "description": "Admin can update any user's password without providing current password"
      },
      "response": []
    },
    {
      "name": "Update Own Password - User",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{user_token}}",
            "description": "User JWT token"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"currentPassword\": \"currentPassword123\",\n  \"newPassword\": \"newSecurePassword123\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/users/{{current_user_id}}/password",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "api",
            "users",
            "{{current_user_id}}",
            "password"
          ]
        },
        "description": "User updating their own password - requires current password"
      },
      "response": []
    },
    {
      "name": "Update Password - Validation Error",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"newPassword\": \"123\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/users/{{user_id}}/password",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "api",
            "users",
            "{{user_id}}",
            "password"
          ]
        },
        "description": "Test validation error - password too short"
      },
      "response": []
    },
    {
      "name": "Update Password - Unauthorized",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{user_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"newPassword\": \"newSecurePassword123\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/users/{{other_user_id}}/password",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "api",
            "users",
            "{{other_user_id}}",
            "password"
          ]
        },
        "description": "Test unauthorized access - non-admin trying to update another user's password"
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000",
      "description": "Base URL for the API"
    },
    {
      "key": "admin_token",
      "value": "",
      "description": "JWT token for admin user"
    },
    {
      "key": "user_token",
      "value": "",
      "description": "JWT token for regular user"
    },
    {
      "key": "user_id",
      "value": "",
      "description": "ID of the user whose password to update"
    },
    {
      "key": "current_user_id",
      "value": "",
      "description": "ID of the current user (for self-update)"
    },
    {
      "key": "other_user_id",
      "value": "",
      "description": "ID of another user (for unauthorized test)"
    }
  ]
}
